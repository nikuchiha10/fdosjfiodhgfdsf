# -*- coding: utf-8 -*-
"""
–£–¢–ò–õ–ò–¢–´ –ò –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
–û–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
"""

import logging
import time
import re
import os
from datetime import datetime, timedelta
from typing import List, Dict, Any, Optional, Union


class –õ–æ–≥–≥–µ—Ä:
    """–ö–ª–∞—Å—Å –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –ø–∞—Ä—Å–µ—Ä–∞"""
    
    def __init__(self, –ø—É—Ç—å_–ª–æ–≥–∞: str = None):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–≥–µ—Ä–∞"""
        self.–ª–æ–≥–≥–µ—Ä = logging.getLogger('–ü–∞—Ä—Å–µ—Ä–ë–∞–∑—ã–ó–Ω–∞–Ω–∏–π')
        self.–ª–æ–≥–≥–µ—Ä.setLevel(logging.INFO)
        
        # –§–æ—Ä–º–∞—Ç—Ç–µ—Ä –¥–ª—è –ª–æ–≥–æ–≤
        —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä = logging.Formatter(
            '%(asctime)s - %(name)s - %(levelname)s - %(message)s',
            datefmt='%Y-%m-%d %H:%M:%S'
        )
        
        # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏
        –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π_–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ = logging.StreamHandler()
        –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π_–æ–±—Ä–∞–±–æ—Ç—á–∏–∫.setFormatter(—Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä)
        self.–ª–æ–≥–≥–µ—Ä.addHandler(–∫–æ–Ω—Å–æ–ª—å–Ω—ã–π_–æ–±—Ä–∞–±–æ—Ç—á–∏–∫)
        
        # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ñ–∞–π–ª–∞
        if –ø—É—Ç—å_–ª–æ–≥–∞:
            —Ñ–∞–π–ª–æ–≤—ã–π_–æ–±—Ä–∞–±–æ—Ç—á–∏–∫ = logging.FileHandler(–ø—É—Ç—å_–ª–æ–≥–∞, encoding='utf-8')
            —Ñ–∞–π–ª–æ–≤—ã–π_–æ–±—Ä–∞–±–æ—Ç—á–∏–∫.setFormatter(—Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä)
            self.–ª–æ–≥–≥–µ—Ä.addHandler(—Ñ–∞–π–ª–æ–≤—ã–π_–æ–±—Ä–∞–±–æ—Ç—á–∏–∫)
    
    def –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è(self, —Å–æ–æ–±—â–µ–Ω–∏–µ: str):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è"""
        self.–ª–æ–≥–≥–µ—Ä.info(—Å–æ–æ–±—â–µ–Ω–∏–µ)
        print(f"[INFO] {—Å–æ–æ–±—â–µ–Ω–∏–µ}")
    
    def –æ—à–∏–±–∫–∞(self, —Å–æ–æ–±—â–µ–Ω–∏–µ: str):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ"""
        self.–ª–æ–≥ger.error(—Å–æ–æ–±—â–µ–Ω–∏–µ)
        print(f"[ERROR] {—Å–æ–æ–±—â–µ–Ω–∏–µ}")
    
    def –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ(self, —Å–æ–æ–±—â–µ–Ω–∏–µ: str):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è"""
        self.–ª–æ–≥ger.warning(—Å–æ–æ–±—â–µ–Ω–∏–µ)
        print(f"[WARNING] {—Å–æ–æ–±—â–µ–Ω–∏–µ}")
    
    def –æ—Ç–ª–∞–¥–∫–∞(self, —Å–æ–æ–±—â–µ–Ω–∏–µ: str):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏"""
        self.–ª–æ–≥ger.debug(—Å–æ–æ–±—â–µ–Ω–∏–µ)
        print(f"[DEBUG] {—Å–æ–æ–±—â–µ–Ω–∏–µ}")


class –í–∞–ª–∏–¥–∞—Ç–æ—Ä:
    """–ö–ª–∞—Å—Å –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö"""
    
    @staticmethod
    def –≤–∞–ª–∏–¥–Ω—ã–π_–∑–∞–≥–æ–ª–æ–≤–æ–∫(–∑–∞–≥–æ–ª–æ–≤–æ–∫: str) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å—Ç–∞—Ç—å–∏
        
        Args:
            –∑–∞–≥–æ–ª–æ–≤–æ–∫: –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
            
        Returns:
            bool: True –µ—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∞–ª–∏–¥–µ–Ω
        """
        if not –∑–∞–≥–æ–ª–æ–≤–æ–∫ or not isinstance(–∑–∞–≥–æ–ª–æ–≤–æ–∫, str):
            return False
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã
        if len(–∑–∞–≥–æ–ª–æ–≤–æ–∫.strip()) < 5:
            return False
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–ª–æ–≤–∞
        —Å–∏—Å—Ç–µ–º–Ω—ã–µ_—Å–ª–æ–≤–∞ = –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è.–°–ò–°–¢–ï–ú–ù–´–ï_–°–õ–û–í–ê
        –∑–∞–≥–æ–ª–æ–≤–æ–∫_–Ω–∏–∂–Ω–∏–π = –∑–∞–≥–æ–ª–æ–≤–æ–∫.lower()
        
        for —Å–ª–æ–≤–æ in —Å–∏—Å—Ç–µ–º–Ω—ã–µ_—Å–ª–æ–≤–∞:
            if —Å–ª–æ–≤–æ in –∑–∞–≥–æ–ª–æ–≤–æ–∫_–Ω–∏–∂–Ω–∏–π and len(–∑–∞–≥–æ–ª–æ–≤–æ–∫.strip()) < 20:
                return False
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (—Ç–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏)
        if re.match(r'^[^a-zA-Z–∞-—è–ê-–Ø0-9]{5,}$', –∑–∞–≥–æ–ª–æ–≤–æ–∫):
            return False
        
        return True
    
    @staticmethod
    def –≤–∞–ª–∏–¥–Ω—ã–π_url(url: str, –±–∞–∑–æ–≤—ã–π_–¥–æ–º–µ–Ω: str = None) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ URL
        
        Args:
            url: URL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
            –±–∞–∑–æ–≤—ã–π_–¥–æ–º–µ–Ω: –û–∂–∏–¥–∞–µ–º—ã–π –¥–æ–º–µ–Ω —Å–∞–π—Ç–∞
            
        Returns:
            bool: True –µ—Å–ª–∏ URL –≤–∞–ª–∏–¥–µ–Ω
        """
        if not url or not isinstance(url, str):
            return False
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–∫–ª—é—á–∞–µ–º—ã—Ö –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤
        –∏—Å–∫–ª—é—á–∞–µ–º—ã–µ_–ø—Ä–µ—Ñ–∏–∫—Å—ã = –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è.–ò–°–ö–õ–Æ–ß–ê–ï–ú–´–ï_–ü–†–ï–§–ò–ö–°–´_URL
        for –ø—Ä–µ—Ñ–∏–∫—Å in –∏—Å–∫–ª—é—á–∞–µ–º—ã–µ_–ø—Ä–µ—Ñ–∏–∫—Å—ã:
            if url.startswith(–ø—Ä–µ—Ñ–∏–∫—Å):
                return False
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–º–µ–Ω–∞ –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω
        if –±–∞–∑–æ–≤—ã–π_–¥–æ–º–µ–Ω and –±–∞–∑–æ–≤—ã–π_–¥–æ–º–µ–Ω not in url:
            return False
        
        return True
    
    @staticmethod
    def –æ—á–∏—Å—Ç–∏—Ç—å_—Ç–µ–∫—Å—Ç(—Ç–µ–∫—Å—Ç: str) -> str:
        """
        –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –æ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤ –∏ —Å–∏–º–≤–æ–ª–æ–≤
        
        Args:
            —Ç–µ–∫—Å—Ç: –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
            
        Returns:
            str: –û—á–∏—â–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
        """
        if not —Ç–µ–∫—Å—Ç:
            return ""
        
        # –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤ –∏ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫
        —Ç–µ–∫—Å—Ç = re.sub(r'\s+', ' ', —Ç–µ–∫—Å—Ç)
        —Ç–µ–∫—Å—Ç = re.sub(r'\n\s*\n', '\n\n', —Ç–µ–∫—Å—Ç)
        
        # –£–¥–∞–ª–µ–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ (–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã –∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏)
        —Ç–µ–∫—Å—Ç = re.sub(r'[^\w\s–∞-—è–ê-–Ø—ë–Å.,!?;:()\-‚Äì‚Äî]', '', —Ç–µ–∫—Å—Ç)
        
        return —Ç–µ–∫—Å—Ç.strip()
    
    @staticmethod
    def –∏–∑–≤–ª–µ—á—å_–æ—Å–Ω–æ–≤–Ω–æ–π_—Ç–µ–∫—Å—Ç(—ç–ª–µ–º–µ–Ω—Ç) -> str:
        """
        –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –∏–∑ —ç–ª–µ–º–µ–Ω—Ç–∞
        
        Args:
            —ç–ª–µ–º–µ–Ω—Ç: WebElement –∏–ª–∏ —Ç–µ–∫—Å—Ç
            
        Returns:
            str: –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
        """
        try:
            if hasattr(—ç–ª–µ–º–µ–Ω—Ç, 'text'):
                —Ç–µ–∫—Å—Ç = —ç–ª–µ–º–µ–Ω—Ç.text
            else:
                —Ç–µ–∫—Å—Ç = str(—ç–ª–µ–º–µ–Ω—Ç)
            
            return –í–∞–ª–∏–¥–∞—Ç–æ—Ä.–æ—á–∏—Å—Ç–∏—Ç—å_—Ç–µ–∫—Å—Ç(—Ç–µ–∫—Å—Ç)
        except Exception as e:
            return ""


class –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤—â–∏–∫:
    """–ö–ª–∞—Å—Å –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö"""
    
    @staticmethod
    def —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å_–≤—Ä–µ–º—è(—Å–µ–∫—É–Ω–¥—ã: float) -> str:
        """
        –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤ —á–∏—Ç–∞–µ–º—ã–π –≤–∏–¥
        
        Args:
            —Å–µ–∫—É–Ω–¥—ã: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–∫—É–Ω–¥
            
        Returns:
            str: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
        """
        if not —Å–µ–∫—É–Ω–¥—ã:
            return "0 —Å–µ–∫"
        
        –≤—Ä–µ–º—è = timedelta(seconds=int(—Å–µ–∫—É–Ω–¥—ã))
        –¥–Ω–∏ = –≤—Ä–µ–º—è.days
        —á–∞—Å—ã = –≤—Ä–µ–º—è.seconds // 3600
        –º–∏–Ω—É—Ç—ã = (–≤—Ä–µ–º—è.seconds % 3600) // 60
        —Å–µ–∫—É–Ω–¥—ã = –≤—Ä–µ–º—è.seconds % 60
        
        —á–∞—Å—Ç–∏ = []
        if –¥–Ω–∏ > 0:
            —á–∞—Å—Ç–∏.append(f"{–¥–Ω–µ–π} –¥")
        if —á–∞—Å—ã > 0:
            —á–∞—Å—Ç–∏.append(f"{—á–∞—Å—ã} —á")
        if –º–∏–Ω—É—Ç—ã > 0:
            —á–∞—Å—Ç–∏.append(f"{–º–∏–Ω—É—Ç—ã} –º")
        if —Å–µ–∫—É–Ω–¥—ã > 0 or not —á–∞—Å—Ç–∏:
            —á–∞—Å—Ç–∏.append(f"{—Å–µ–∫—É–Ω–¥—ã} —Å")
        
        return " ".join(—á–∞—Å—Ç–∏)
    
    @staticmethod
    def —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å_—Ä–∞–∑–º–µ—Ä_—Ñ–∞–π–ª–∞(–±–∞–π—Ç—ã: int) -> str:
        """
        –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
        
        Args:
            –±–∞–π—Ç—ã: –†–∞–∑–º–µ—Ä –≤ –±–∞–π—Ç–∞—Ö
            
        Returns:
            str: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä
        """
        if –±–∞–π—Ç—ã < 1024:
            return f"{–±–∞–π—Ç—ã} –ë"
        elif –±–∞–π—Ç—ã < 1024 * 1024:
            return f"{–±–∞–π—Ç—ã / 1024:.1f} –ö–ë"
        else:
            return f"{–±–∞–π—Ç—ã / (1024 * 1024):.1f} –ú–ë"
    
    @staticmethod
    def —Å–æ–∑–¥–∞—Ç—å_—Å—Ç—Ä—É–∫—Ç—É—Ä—É_—Ñ–∞–π–ª–∞(—Å—Ç–∞—Ç—å–∏: List[Dict]) -> str:
        """
        –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã TXT —Ñ–∞–π–ª–∞
        
        Args:
            —Å—Ç–∞—Ç—å–∏: –°–ø–∏—Å–æ–∫ —Å—Ç–∞—Ç–µ–π
            
        Returns:
            str: –¢–µ–∫—Å—Ç —Ñ–∞–π–ª–∞
        """
        —Ç–µ–∫—É—â–µ–µ_–≤—Ä–µ–º—è = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        
        –∑–∞–≥–æ–ª–æ–≤–æ–∫ = f"=== –ë–ê–ó–ê –ó–ù–ê–ù–ò–ô - {len(—Å—Ç–∞—Ç—å–∏)} –°–¢–ê–¢–ï–ô ===\n"
        –∑–∞–≥–æ–ª–æ–≤–æ–∫ += f"–í—Ä–µ–º—è —Å–±–æ—Ä–∞: {—Ç–µ–∫—É—â–µ–µ_–≤—Ä–µ–º—è}\n\n"
        
        —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ = ""
        
        for –∏–Ω–¥–µ–∫—Å, —Å—Ç–∞—Ç—å—è in enumerate(—Å—Ç–∞—Ç—å–∏, 1):
            —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ += f"–°–¢–ê–¢–¨–Ø {–∏–Ω–¥–µ–∫—Å}: {—Å—Ç–∞—Ç—å—è.get('–∑–∞–≥–æ–ª–æ–≤–æ–∫', '–ù–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞')}\n"
            —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ += f"URL: {—Å—Ç–∞—Ç—å—è.get('url', '–ù–µ—Ç URL')}\n"
            —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ += f"–¢–∏–ø: {—Å—Ç–∞—Ç—å—è.get('—Ç–∏–ø', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')}\n"
            —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ += f"–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: {—Å—Ç–∞—Ç—å—è.get('–≤—Ä–µ–º—è_–æ–±—Ä–∞–±–æ—Ç–∫–∏', '0')}—Å\n\n"
            
            # –ó–∞–≥–æ–ª–æ–≤–∫–∏
            –∑–∞–≥–æ–ª–æ–≤–∫–∏ = —Å—Ç–∞—Ç—å—è.get('–∑–∞–≥–æ–ª–æ–≤–∫–∏', [])
            if –∑–∞–≥–æ–ª–æ–≤–∫–∏:
                —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ += f"–ó–ê–ì–û–õ–û–í–ö–ò: {' | '.join(–∑–∞–≥–æ–ª–æ–≤–∫–∏[:3])}\n"
            else:
                —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ += "–ó–ê–ì–û–õ–û–í–ö–ò: –ù–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤\n"
            
            # –¢–µ–∫—Å—Ç (–ø–µ—Ä–≤—ã–µ 200 —Å–∏–º–≤–æ–ª–æ–≤)
            —Ç–µ–∫—Å—Ç = —Å—Ç–∞—Ç—å—è.get('—Ç–µ–∫—Å—Ç', '')
            if —Ç–µ–∫—Å—Ç:
                –ø—Ä–µ–≤—å—é_—Ç–µ–∫—Å—Ç–∞ = —Ç–µ–∫—Å—Ç[:200] + "..." if len(—Ç–µ–∫—Å—Ç) > 200 else —Ç–µ–∫—Å—Ç
                —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ += f"–¢–ï–ö–°–¢: {–ø—Ä–µ–≤—å—é_—Ç–µ–∫—Å—Ç–∞}\n"
            else:
                —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ += "–¢–ï–ö–°–¢: –ù–µ—Ç —Ç–µ–∫—Å—Ç–∞\n"
            
            # –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ä–∞–∑–¥–µ–ª—ã
            —Ä–∞–∑–¥–µ–ª—ã = —Å—Ç–∞—Ç—å—è.get('–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ_—Ä–∞–∑–¥–µ–ª—ã', [])
            if —Ä–∞–∑–¥–µ–ª—ã:
                —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ += "–í–ù–£–¢–†–ï–ù–ù–ò–ï –†–ê–ó–î–ï–õ–´:\n"
                for —Ä–∞–∑–¥–µ–ª in —Ä–∞–∑–¥–µ–ª—ã[:5]:  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º 5 —Ä–∞–∑–¥–µ–ª–∞–º–∏
                    –Ω–∞–∑–≤–∞–Ω–∏–µ = —Ä–∞–∑–¥–µ–ª.get('–Ω–∞–∑–≤–∞–Ω–∏–µ', '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è')
                    —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ = —Ä–∞–∑–¥–µ–ª.get('—Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ', '')[:100]
                    —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ += f"‚Ä¢ {–Ω–∞–∑–≤–∞–Ω–∏–µ}: {—Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ}...\n"
            else:
                —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ += "–í–ù–£–¢–†–ï–ù–ù–ò–ï –†–ê–ó–î–ï–õ–´: –ù–µ—Ç —Ä–∞–∑–¥–µ–ª–æ–≤\n"
            
            —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ += "\n" + "="*50 + "\n\n"
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –∫–æ–Ω—Ü–µ
        —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ = "\nüìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –°–ë–û–†–ê:\n"
        —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ += f"‚Ä¢ –í—Å–µ–≥–æ —Å—Ç–∞—Ç–µ–π: {len(—Å—Ç–∞—Ç—å–∏)}\n"
        
        –æ–±—â–µ–µ_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Ä–∞–∑–¥–µ–ª–æ–≤ = sum(len(—Å—Ç.get('–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ_—Ä–∞–∑–¥–µ–ª—ã', [])) for —Å—Ç in —Å—Ç–∞—Ç—å–∏)
        —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ += f"‚Ä¢ –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Ä–∞–∑–¥–µ–ª–æ–≤: {–æ–±—â–µ–µ_–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Ä–∞–∑–¥–µ–ª–æ–≤}\n"
        
        –æ–±—â–µ–µ_–≤—Ä–µ–º—è = sum(—Å—Ç.get('–≤—Ä–µ–º—è_–æ–±—Ä–∞–±–æ—Ç–∫–∏', 0) for —Å—Ç in —Å—Ç–∞—Ç—å–∏)
        —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ += f"‚Ä¢ –û–±—â–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: {–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤—â–∏–∫.—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å_–≤—Ä–µ–º—è(–æ–±—â–µ–µ_–≤—Ä–µ–º—è)}\n"
        
        if –æ–±—â–µ–µ_–≤—Ä–µ–º—è > 0:
            —Å–∫–æ—Ä–æ—Å—Ç—å = len(—Å—Ç–∞—Ç—å–∏) / (–æ–±—â–µ–µ_–≤—Ä–µ–º—è / 60)
            —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ += f"‚Ä¢ –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å: {—Å–∫–æ—Ä–æ—Å—Ç—å:.1f} —Å—Ç–∞—Ç–µ–π/–º–∏–Ω\n"
        
        return –∑–∞–≥–æ–ª–æ–≤–æ–∫ + —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ + —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞


class –û–±—Ä–∞–±–æ—Ç—á–∏–∫–û—à–∏–±–æ–∫:
    """–ö–ª–∞—Å—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫"""
    
    def __init__(self, –ª–æ–≥–≥–µ—Ä: –õ–æ–≥–≥–µ—Ä):
        self.–ª–æ–≥–≥–µ—Ä = –ª–æ–≥–≥–µ—Ä
        self.–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–æ—à–∏–±–æ–∫ = 0
    
    def –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–æ—à–∏–±–∫—É(self, –æ—à–∏–±–∫–∞: Exception, –∫–æ–Ω—Ç–µ–∫—Å—Ç: str = "") -> str:
        """
        –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
        
        Args:
            –æ—à–∏–±–∫–∞: –û–±—ä–µ–∫—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è
            –∫–æ–Ω—Ç–µ–∫—Å—Ç: –ö–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –æ—à–∏–±–∫–∏
            
        Returns:
            str: –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
        """
        self.–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–æ—à–∏–±–æ–∫ += 1
        
        —Å–æ–æ–±—â–µ–Ω–∏–µ_–æ–±_–æ—à–∏–±–∫–µ = f"{–∫–æ–Ω—Ç–µ–∫—Å—Ç}: {str(–æ—à–∏–±–∫–∞)}" if –∫–æ–Ω—Ç–µ–∫—Å—Ç else str(–æ—à–∏–±–∫–∞)
        
        self.–ª–æ–≥–≥–µ—Ä.–æ—à–∏–±–∫–∞(—Å–æ–æ–±—â–µ–Ω–∏–µ_–æ–±_–æ—à–∏–±–∫–µ)
        
        return —Å–æ–æ–±—â–µ–Ω–∏–µ_–æ–±_–æ—à–∏–±–∫–µ
    
    def –ø–æ–ª—É—á–∏—Ç—å_—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É_–æ—à–∏–±–æ–∫(self) -> Dict[str, Any]:
        """
        –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –æ—à–∏–±–∫–∞–º
        
        Returns:
            Dict: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫
        """
        return {
            "–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–æ—à–∏–±–æ–∫": self.–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–æ—à–∏–±–æ–∫,
            "–≤—Ä–µ–º—è_–ø–æ—Å–ª–µ–¥–Ω–µ–π_–æ—à–∏–±–∫–∏": datetime.now().isoformat() if self.–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–æ—à–∏–±–æ–∫ > 0 else None
        }


# –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã
–ª–æ–≥–≥–µ—Ä = –õ–æ–≥–≥–µ—Ä()
–≤–∞–ª–∏–¥–∞—Ç–æ—Ä = –í–∞–ª–∏–¥–∞—Ç–æ—Ä()
—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤—â–∏–∫ = –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤—â–∏–∫()
